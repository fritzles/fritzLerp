<html>
  <head>
    <script src="https://cdn.socket.io/socket.io-1.2.1.js"></script>
    <!-- See more examples at developer.leapmotion.com -->
    <base href="https://editor-leapmotion.netdna-ssl.com/leapmotion-examples/javascript/33bb9af093dab3c51c37279e7f68374b5bc87e57/v2/left-right/index.html.livegit?theme-id=4245&height=600" />
    <title>Handedless Demo</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r66/three.js"></script>
    <script src="//js.leapmotion.com/leap-0.6.2.min.js"></script>
    <script src="//js.leapmotion.com/leap-plugins-0.1.6.1.js"></script>
    <script src="//js.leapmotion.com/leap.rigged-hand-0.1.3.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <style>
      body{
        font-family: 'Myriad Pro', Helvetica, Arial, 'Lucida Grande', sans-serif;
        font-size: 24pt;
        color: white;
        background-color: #80b865;
      }
      label {
        position: fixed;
        white-space: nowrap;
      }
    </style>
  </head>

  <body>
    <div id="labels"></div>
    <div id="date"></div>
    <div id="stats"></div>
  </body>

  

  <script type="text/javascript">

  var socket = io.connect('http://54.68.163.235:80/leap');
  var dateTemp;
  $('#date').text("Loading...");

  socket.on('date', function(data){
        $('#date').text(data.date);
        dateTemp = data.date;
      });

 

  var riggedHandPlugin;

    // function isSigning(thumb, index, middle, ring, pinky ){
    //     var thing = (thumb*1) + (index*2) + (middle*4) + (ring*8) + (pinky*16);
        
    //     switch(thing){
    //       case 0:
    //         return 0;
            
    //       case 2:
    //         return 1;
            
    //       case 6:
    //         return 2;
            
    //       case 7:
    //         return 3;
            
    //       case 30:
    //         return 4;
    //       case 31:
    //         return 5;
            
    //       case 14:
    //         return 6;
    //       case 22:
    //         return 7;
    //       case 26:
    //         return 8;
    //       case 28:
    //         return 9;
    //       default:
    //         return "Not Recognized";
            
    //     } }
    var fingerData = 0;
   
    setInterval(function(){
            socket.emit('fingers', {"fingerData":fingerData});
        }, 1000);

    

    Leap.loop({
      hand: function(hand){
        
        
        var label = hand.data('label');
        var position = hand.palmPosition;

        var fingers = [];

        for(var f = 0; f < hand.fingers.length; f++){
              var finger = hand.fingers[f];
              fingers.push(finger);
        }


        if (!label){

          label = document.createElement('label');
          document.body.appendChild(label);

          /**
           * Here we set the label to show the hand type
           */
          
          hand.data('label', label)

        }
        // var isExtended = [];
        // var i;
        
        // fingers.forEach(function(extend){
        //   i = Number(extend.extended);
        //   isExtended.push(i);
        // })



        //Determine what gesture it is
        
        // label.innerHTML = isSigning(isExtended[0],isExtended[1],isExtended[2],isExtended[3],isExtended[4]);

        var stringToPass = "";
        for(i = 0; i < 5; i++){
          var finger = hand.fingers[i];
          for(j = 0; j < 4; j++){
            var bone = finger.bones[j];
            var boneBase = bone.prevJoint;
            var boneTip = bone.nextJoint;
            var xTip = boneTip[0];
            var yTip = boneTip[1];
            var zTip = boneTip[2];
            if( (j==0) || (j==3) ){
              stringToPass += xTip + ",";
              stringToPass += yTip + ",";
              stringToPass += zTip + ",";
            }
          }
        }

        label.innerHTML = stringToPass;
        fingerData = stringToPass;

        

       
        var handMesh = hand.data('riggedHand.mesh');

        var screenPosition = handMesh.screenPosition(
          hand.palmPosition,
          riggedHandPlugin.camera
        );

        label.style.left = screenPosition.x + 'px';
        label.style.bottom = screenPosition.y + 'px';

      }
    })
    .use('riggedHand')
    .use('handEntry')
    .on('handLost', function(hand){
        var label = hand.data('label');
        if (label){
          document.body.removeChild(label);
          hand.data({label: undefined});
        }
    })
    .use('playback', {
      recording: './left-or-right-77fps.json.lz',
      timeBetweenLoops: 1000
    });

    riggedHandPlugin = Leap.loopController.plugins.riggedHand;

    </script>
  
</html>